{#
/**
* Theme layout to display a UCB Person Page.
*
* Created by jcsparks on 8/31/21
*/
#}

{{ attach_library('boulder_base/ucb-page') }}
{{ attach_library('boulder_base/ucb-person') }}

{% set classes = [
	'node',
	'node--type-' ~ node.bundle|clean_class,
	not node.isPublished() ? 'node--unpublished',
	view_mode ? 'node--view-mode-' ~ view_mode|clean_class,
] %}

<<<<<<< HEAD
{% set articlesJSON = (url('<front>')|render|trim('/'))
    ~ '/jsonapi/node/ucb_article'
    ~ '?include[node--ucb_article]=uid,title,ucb_article_content,created,field_ucb_article_summary,field_ucb_article_byline,field_ucb_article_categories,field_ucb_article_tags,field_ucb_article_thumbnail'
    ~ '&include=field_ucb_article_thumbnail.field_media_image'
    ~ '&fields[file--file]=uri,url'
  %}

    {# Filter on only published (status = true) content #}
	{% set PublishedFilter = '&filter[publish-check][condition][path]=status'
    ~ '&filter[publish-check][condition][value]=1'
    ~ '&filter[publish-check][condition][memberOf]=published'
  %}

    {# pagination filter #}
	{% set pageCount = 10 %}
	{% set pageCountFilter = '&page[limit]=' ~ pageCount %}
	
	{# sorting filter #}
	{% set sortFilter = '&sort[sort-created][path]=created&sort[sort-created][direction]=DESC' %}


=======
>>>>>>> main

<article{{attributes.addClass(classes)}} itemscope itemtype="https://schema.org/Person">
	<div class="container ucb-person-header">
		<h1 class="ucb-person-name">
			{{ content.field_ucb_person_first_name }}
			{{ content.field_ucb_person_last_name }}
		</h1>
		{{ content.field_ucb_person_pronouns }}
	</div>
	<div class="container ucb-person">
		<div class="row ucb-person-personal">
			<div class="col ucb-person-main">
				{{ content.field_ucb_person_photo }}
				{% if content.field_ucb_person_title.0 or content.field_ucb_person_department.0 %}
					<div class="ucb-person-section ucb-person-job">
						{{ content.field_ucb_person_title }}
						{{ content.field_ucb_person_department }}
					</div>
				{% endif %}
				{% if content.field_ucb_person_email.0 or content.field_ucb_person_phone.0 or content.field_ucb_person_primary_link.0 %}
					<div class="ucb-person-section ucb-person-contact">
						{{ content.field_ucb_person_email }}
						{{ content.field_ucb_person_phone }}
						{{ content.field_ucb_person_primary_link }}
					</div>
				{% endif %}
				{% if content.field_ucb_person_links.0 %}
					<div class="ucb-person-section ucb-person-links">
						{{ content.field_ucb_person_links }}
					</div>
				{% endif %}
				{% if content.field_ucb_person_address.0 %}
					<div class="ucb-person-section" aria-labelledby="headerAddress">
						<span class="ucb-person-section-header" id="headerAddress">Address</span>
						{{ content.field_ucb_person_address }}
					</div>
				{% endif %}
				{% if content.field_ucb_person_office_hours.0 %}
					<div class="ucb-person-section ucb-person-office-hours" aria-labelledby="headerOfficeHours">
						<span class="ucb-person-section-header" id="headerOfficeHours">Office Hours</span>
						{{ content.field_ucb_person_office_hours }}
					</div>
				{% endif %}
				{% if content.body.0 %}
					<div class="ucb-person-section ucb-person-body">
						{{ content.body }}
					</div>
				{% endif %}
			</div>
			<person-article-list
  				jsonapi="{{ articlesJSON }}{{ PublishFilter }}{{ pageCountFilter }}{{ sortFilter }}"
  			>
				<div id="ucb-al-loading" class="ucb-list-msg ucb-loading-data">
					<i class="fas fa-spinner fa-3x fa-pulse"></i>
				</div>
				<div id="ucb-al-error" style="display:none" class="ucb-list-msg">
					<h3>An error has occured - please check your filters and try again</h3>
				</div>
				<div id="ucb-al-api-error" style="display:none" class="ucb-list-msg">
					<h3>An error has occured with the API - please try again later</h3>
				</div>
			</person-article-list>
		</div>
	</div>
</article>
